# Make your own Hackpad! 

Hey! Want to make your own macropad but have absolutely no clue where to start? You found the right place! In this tutorial, we're going to make a 4-key macropad as an example. **For a full submission, you will have to edit it to be your own** (add an extra key?? a knob?? new case? up to you!)

**Read over the [FAQ](/faq) first so that you have an idea of what you're working with!**

This process is going to be broken into 3 parts, each with its own sub-parts:
- [PCB Design](#pcb_design)
  - [Drawing the schematic](#schematic)
  - [Routing the PCB](#routing)
  - [Adding 3D models](#3d_models)
- [Common Case Design](#case_design_common)
- [Figma Case Design](#case_design_fusion)
  - [Creating the bottom](#bottom)
  - [Creating the top](#top)
  - [Finishing touches](#finishing)
- [FreeCad Case Design](#case_design_freecad)
  - [Creating the bottom](#bottom)
- [Firmware](#firmware)
  - [Code!](#code)


If you're unsure about anything, send a message in #hackpad! We have so many eager people to help. 

There's also [this](/resources) giant wall of resources to reference!

Here is also a guide on [advanced PCB components](/advancedPCB)

Lets start with:

<a name="pcb_design"/>
## Designing your PCB

For this guide we're going to be using [KiCad](https://www.kicad.org/), which is an open source PCB designer tool.   

To start, we're going to have to install the kicad library! We are going to use the following respository
- [OPL Kicad Library](https://github.com/Seeed-Studio/OPL_Kicad_Library/) 

There are many tutorials on how to install libraries! Google is your best friend here :)

@Cyao in the slack did make an awesome tutorial though! Here it is:
<video width="100%" controls>
  <source src="https://cloud-547suu6q6-hack-club-bot.vercel.app/0r.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video>

<a name="schematic"/>
### Drawing the Schematic

Start by opening up KiCad, a window will pop up, create a new project then click on the "Schematic Editor" button:

<img src="/docs/v2/schematicbutton.png" className="max-w-96" />

This should open up a new window with your schematic editor! Once you're in, press the A key on your keyboard. This should open up a menu where you can add **symbols** for your different components! Search for the following to add them:
- XIAO-RP2040-DIP (your microcontroller)
- SW_Push (This will be our keyboard switch! Copy and paste this 4 times)
- SK6812 MINI LED (its an RGB LED - I will be using 2 of these!)

Start by placing these symbols down. They don't have to be in any particular order, but place them somewhat close together

To rotate the symbols, click R. And to mirror them, click X.

<img src="/docs/v2/placedcomponents.png" className="max-w-96" />

Afterwards, it should look something like this ^^

Now it's time to start wiring. Hit the W key on your keyboard to start wiring! This should make a green wire start to appear. Connect your components like so:

<img src="/docs/v2/wiredcomponents.png" className="max-w-96" />

Don't forget to add the GND and +5V symbols! Press P and search for it.

Once all the components are connected, we can start assigning **footprints** to the symbols we have here. Footprints are what gets physically drawn on the PCB. To do this, click the "run footprint assignment tool" in the top right.

<img src="/docs/v2/assignfootprints.png" className="max-w-96" />

This should open up a window where you can assign different footprints to your components! Assign them based on the image below:

<img src="/docs/v2/assignedfootprints.png" className="max-w-200" />

Once you're done, you can hit apply & save schematic. We're now officially done with the schematic! Onto making the pcb itself:

<a name="routing"/>
### Routing the PCB

Great job on finishing the schematic! Hit this button to open the PCB editor: 

<img src="/docs/v2/switchtopcb.png" className="max-w-96" />

Hit the "Update PCB from schematic" button in the top right. This will bring in all your parts!

<img src="/docs/v2/updatefromschematic.png" className="max-w-96" />

Click anywhere on your screen to place your components down, it should look something like this:

<img src="/docs/v2/pcbstart.png" className="max-w-96" />

First, to be able to better place the components, we would need to change the grid. 

Grids are used to allow efficient placement, movement and connection between symbols and wires. It defines what is the spacing of the grid, which components will snap to.

Select the button at the top that says "1.2700 mm (50 mils)" (Replace xx by a arbitrary number). You can use this menu to change what grid you are on. hen click on Edit Grids...

<img src="/docs/v2/grid.png" className="max-w-96" />

You should have the following menu open:

<img src="/docs/v2/editgrid.png" className="max-w-96" />

Now click on the + button at the bottom left, and enter "2.38125" in the field named "X". Press Ok then Ok again. Now you have defined a cutom grid!

We now need to place the components!

Select a footprint, drag it around to move it (Or if you prefer, click a component to select it, press M to move it and click again to put it down). To rotate the footprint, press R when selecting it.

When placing the switches, I recommend you to use the newly defined grid of 2.38125 mm (Select it in the menu). **Important**: While moving the switches, select the blue circle at the center. This will make sure all the switches are alighed properly. You should align the outer while lines of the switches as so:

<img src="/docs/v2/align.png" className="max-w-96" />

There is a front side and back side of the board. You can tell them apart by color

<img src="/docs/v2/frontback.png" className="max-w-96" />

If you want to put the footprint on the back side, press F. Here is what the footprints look like on different sides:

<img src="/docs/v2/compfrontback.png" className="max-w-96" />

Move, rotate and flip your footprints into a design that you like! It should looks like this:

<img src="/docs/v2/placedfootprints.png" className="max-w-96" />

You need to define the outline of the board. Select the Edge.Cuts layer on the right toolbar.

<img src="/docs/v2/righttoolbar.png" className="max-w-96" />

Now, you can use the "Draw Rectangle" button to draw the boarders of the board:

<img src="/docs/v2/edgecutsselect.png" className="max-w-96" />

This shall be the size of your physical board.

**IMPORTANT**! Remember to have the head of the XIAO poking out of the Edge.Cuts rectangle. This is mandatory to be able to plug your USB cable in.

<img src="/docs/v2/xiaohead.png" className="max-w-96" />

Now it's time to route the PCB! Hit X on your keyboard and hit any golden pad with a thin blue line poking out. It should dim the entire screen and show you where to go:

<img src="/docs/v2/routing.png" className="max-w-96" />

Join the highlighted pads together. If there isn't enough space on the front side, or there is a trace already present that is blocking you, you can route on the back side by clicking B.Cu on the right toolbar. At the same time, if you want to change sides during routing, you can press V, and a via shall be added, and you will be on the other side of the board:

<img src="/docs/v2/via.png" className="max-w-96" />

**Attention**! Wires and pads of different colors (except golden) can't be connected together directly! You must via to the other side.

Continue until there are no thin blue lines on the screen! Your final product should look something like this:

<img src="/docs/v2/finalpcb.png" className="max-w-96" />

Also, it is **VERY IMPORTANT** that you brand your hackpad! Put the name of your hackpad on any silkscreen of your PCB. Do this by using the text tool. Also, write "XIAO HERE" on the side you would like your XIAO to be placed on. 

To do this select F.Silkscreen (If your xiao is on the back side, use B.Silkscreen when placing the "XIAO HERE" text), and click on the add text button:

<img src="/docs/v2/addtext.png" className="max-w-96" />

Enter your text and place it down! 

<img src="/docs/v2/realfinalpcb.png" className="max-w-96" />

Good stuff! You're almost done the PCB. Let's run the DRC to make sure the PCB works. The silkscreen warnings you see are okay, make sure there are no more errors! Here is a [list of all DRC errors you might encounter](/errors)

<img src="/docs/v2/drcbutton.png" className="max-w-96" />

PS. You might need to cheange tabs to see all errors. (Click on "Unconnected Items")

Thats all for your PCB! Great job.

If you aren't satisfied and wan't something more advanced, [check out the advanced PCB guide!](/advancedPCB)

<a name="3d_models"/>
### Bonus: 3D models!

You currently can view the 3D version of your PCB by pressing Alt+3 (Option+3 on some platforms). It should look something like this:

<img src="/docs/v2/3d-view.png" className="max-w-96" />

Oh no! We are missing some 3D Models. Here we will learn how you add them.

First, you must find 3D Models for your components on the internet, but here if @Cyao's trusty list of common models:

- [Seeed-Studio Xiao](https://rawcdn.githack.com/cheyao/macropad/642f4e5dbdabb88147ccd878850d199042967667/PCB/third_party/xiao.step)
- [MX v2 (Models for the switches)](https://rawcdn.githack.com/cheyao/aniboard/835d8a1c2ee60be4e0bc82223e744c2568955295/PCB/MX%20v2.step)
- [Neopixel SK6812_Mini](https://rawcdn.githack.com/StefanHamminga/kicad-packages3D/395108dcab363619c3c82ad00e060acd423aeeb7/LED_SMD.3dshapes/SK6812_Mini.step)
- [Reverse Mount Neopixel](https://rawcdn.githack.com/cheyao/macropad/642f4e5dbdabb88147ccd878850d199042967667/PCB/third_party/neopixel.petty/SK6812MINI-E.step)
- [128x64 SSD1306 OLED Display](https://rawcdn.githack.com/cheyao/macropad/642f4e5dbdabb88147ccd878850d199042967667/PCB/third_party/KiCad-SSD1306-128x64-master/SSD1306_OLED_Display(128x64).step)
- [Kailh Choc v2 switched (You probably don't need this one)](https://rawcdn.githack.com/cheyao/macropad/642f4e5dbdabb88147ccd878850d199042967667/PCB/third_party/Kailh-Choc-V2.step)

Note: On some Linux distributions, you need to download the built-in kicad 3d models seperatly, most likely called "kicad-library-3d"

You can find tons of information on how to add the models online! But here is a video that walks you through anyways :3

FIXME: Make the video

<video width="100%" controls>
  <source src="" type="video/mp4" />
  Your browser does not support the video tag.
</video>

Now to export the PCB as a 3D Model, select File > Export > STEP...

<img src="/docs/v2/exportstep.png" className="max-w-96" />

And select the directory you want the output to be in, then click Export. You don't need to change any settings. In the end you will get a .STEP file, that is the 3D model of your PCB.

<a name="case_design_common"/>
## Common case design part

First thing first, go to [ai03's plate generator](https://kbplate.ai03.com/).

In the KLE Data fiels, you need to enter some custom json data. For example

["", "", ""],
["", "", ""],

Is for a macropad that has 3 keys in each column and 2 rows

If your keyboard is more complex, you can use [keyboard-layout-editor.com](https://www.keyboard-layout-editor.com/) to generate the json data. (Modify the layout, open the "Raw data" tab at the middle of the page and copy & paste)

After that, scroll down and look at the preview to verify if it conforms to your macropad, and press download DXF.

Now that you are done with generating your plates, it's time to choose which 3d modeling sofware you want to use. We have guides for the following softwares:

- [Figma Case Design](#case_design_fusion)
- [FreeCad Case Design](#case_design_freecad)

<a name="case_design_fusion"/>
## Creating your case in Fusion360

- Difficulty: 2/5

This guide uses [Fusion360](https://www.autodesk.com/products/fusion-360/personal) for designing the case. You can use other software, but it may be harder to follow along!

<a name="bottom"/>
### Creating the bottom
Start by creating a new project, and a new component, this is better for organization. 

<img src="/docs/v2/newcomponent.png" className="max-w-96" />

Next, create a sketch by by pressing the green + button. Create a rectangle that is 0.5mm bigger than your hackpad's PCB. For example, my PCB is 42mm x 61.5mm, I added 0.5mm to each on the sketch.

<img src="/docs/v2/1sketch1.png" className="max-w-96" />
<img src="/docs/v2/1sketch2.png" className="max-w-96" />

Create another rectangle with 10mm extra on each dimension! (5mm bigger on each side) Center this rectangle by pressing the dimension button and setting the values to 5mm.

<img src="/docs/v2/sketchdimension.png" className="max-w-96" />
<img src="/docs/v2/properdimension.png" className="max-w-96" />

It should look something like this when you're completed! 

<img src="/docs/v2/finishsketch.png" className="max-w-96" />

Select the outer rectangle and press extrude, extrude the outer by 13mm, and then do the same with the inner rectangle by 3mm.

<img src="/docs/v2/halfextrude.png" className="max-w-96" />

Thats the base of your case done! Next, lets create another sketch, this time creating circles with a diameter of 3.2mm, and 2.75mm from each edge. Extrude it to make it a hole! 

<img src="/docs/v2/holesforcase.png" className="max-w-96" />

<a name="top"/>
### Creating the top

Next, we will make the other half to our case. Start by creating yet another sketch, making it the same size as the bottom half of the case. Create the holes like before, and then create 4 14mm x 14mm squares. Follow these dimensions: 

<img src="/docs/v2/topsketch.png" className="max-w-96" />

Almost done, create another rectangle 18mm x 21mm, 17mm away from both edges and 5mm from the top, and extrude that plate by 3mm.

<img src="/docs/v2/topextrude.png" className="max-w-96" />

Right now our case looks a little ugly, its so blocky! Lets round the corners, press the Fillet button found in the top, and click on each edge and make it 2mm. Select the top edge of the case and make that 1mm. Should look as such:

<img src="/docs/v2/fillet.png" className="max-w-96" />
<img src="/docs/v2/edgeround.png" className="max-w-96" />

Make sure to cut out a port hole for your xiao, the best method is to add 3d models to your PCB, and test fit everything. You can import the .STEP file of your PCB, and test fit everything. After I test fitted everything, I made a few modifications.

<img src="/docs/v2/casebottom.png" className="max-w-96" />

<a name="finishing"/>
### Finishing Touches

Next, we will brand our case! This part will not be seen and is for us to be able to keep track of who's submission is whos. Go to the bottom of the case, or somewhere that won't be seen, and create a new sketch. Make a text box, and enter the name of your hackpad on it. 

<img src="/docs/v2/createtext.png" className="max-w-96" />

Extrude this sketch 0.2mm INTO the case, don't worry about the overhang! If you are getting an error when extruding, keep the font as Arial.

<img src="/docs/v2/extrudedtext.png" className="max-w-96" />

Thats it! Your case is now done.

<img src="/docs/v2/finalcase.png" className="max-w-96" />

I would also recommend importing 3d models of all your components to test fit everything: 

<img src="/docs/v2/testedcase.png" className="max-w-96" />

<a name="case_design_freecad"/>
## Creating your case in FreeCad

- Difficulty: 4/5

First, download [FreeCad](https://www.freecad.org/), and open the application.

As a forenote, FreeCad comes with a lot of quirks, so when you are blocked, google will be your best friend.

<a name="firmware"/>
<a name="code"/>
## Firmware

This tutorial uses the [QMK firmware](https://qmk.fm/) project as firmware! You can find out how to port your keyboard here: \
[QMK Porting Guide](https://docs.qmk.fm/porting_your_keyboard_to_qmk)

# Next steps
We just made a pretty cool macropad, but obviously there's a lot of cooler stuff out there - that's up to you to figure out! Again, don't copy this guide 1:1, add your own design into it.

